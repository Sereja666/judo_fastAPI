<!-- templates/partials/edit_students/student_form.html -->
<form id="studentForm">
    <input type="hidden" id="studentId" name="student_id">

    <!-- Основная информация -->
    <div class="form-section">
        <h5 class="section-title"><i class="fas fa-user"></i> Основная информация</h5>
        <div class="row">
            <div class="col-md-6 mb-3">
                <label for="name" class="form-label">ФИО ученика *</label>
                <input type="text" class="form-control" id="name" name="name" required>
            </div>
            <div class="col-md-6 mb-3">
                <label for="birthday" class="form-label">Дата рождения</label>
                <input type="date" class="form-control" id="birthday" name="birthday">
            </div>
            <div class="col-md-12 mb-3">
                <div class="form-check form-switch">
                    <input class="form-check-input" type="checkbox" id="active" name="active" checked>
                    <label class="form-check-label" for="active">
                        Активный ученик
                    </label>
                </div>
                <div class="form-text">Если снять галочку, ученик будет скрыт из списков</div>
            </div>
        </div>

        <div class="row">
            <div class="col-md-4 mb-3">
                <label for="sport_discipline" class="form-label">Дисциплина</label>
                <select class="form-select" id="sport_discipline" name="sport_discipline">
                    <option value="">-- Выберите дисциплину --</option>
                    {% for sport in sports %}
                    <option value="{{ sport.id }}">{{ sport.name }}</option>
                    {% endfor %}
                </select>
            </div>
            <div class="col-md-4 mb-3">
                <label for="rang" class="form-label">Цвет пояса</label>
                <select class="form-select" id="rang" name="rang">
                    <option value="">-- Выберите цвет пояса --</option>
                    {% for belt in belt_colors %}
                    <option value="{{ belt.id }}">{{ belt.name }} ({{ belt.color }})</option>
                    {% endfor %}
                </select>
            </div>
            <div class="col-md-4 mb-3">
                <label for="sports_rank" class="form-label">Разряд/звание</label>
                <select class="form-select" id="sports_rank" name="sports_rank">
                    <option value="">-- Выберите разряд --</option>
                    {% for rank in sports_ranks %}
                    <option value="{{ rank.id }}">{{ rank.rank }}</option>
                    {% endfor %}
                </select>
            </div>
        </div>

        <div class="row">
            <div class="col-md-6 mb-3">
                <label for="weight" class="form-label">Вес (кг)</label>
                <input type="number" class="form-control" id="weight" name="weight" min="0">
            </div>
            <div class="col-md-6 mb-3">
                <label for="telephone" class="form-label">Телефон</label>
                <input type="tel" class="form-control" id="telephone" name="telephone">
            </div>
        </div>
    </div>

    <!-- Тренеры -->
    <div class="form-section">
        <h5 class="section-title"><i class="fas fa-user-tie"></i> Тренеры</h5>
        <div class="row">
            <div class="col-md-6 mb-3">
                <label for="head_trainer_id" class="form-label">Главный тренер</label>
                <select class="form-select" id="head_trainer_id" name="head_trainer_id">
                    <option value="">-- Выберите тренера --</option>
                    {% for trainer in trainers %}
                    <option value="{{ trainer.id }}">{{ trainer.name }}</option>
                    {% endfor %}
                </select>
            </div>
            <div class="col-md-6 mb-3">
                <label for="second_trainer_id" class="form-label">Второй тренер</label>
                <select class="form-select" id="second_trainer_id" name="second_trainer_id">
                    <option value="">-- Выберите тренера --</option>
                    {% for trainer in trainers %}
                    <option value="{{ trainer.id }}">{{ trainer.name }}</option>
                    {% endfor %}
                </select>
            </div>
        </div>
    </div>

    <!-- Оплата -->
    <div class="form-section">
        <h5 class="section-title"><i class="fas fa-credit-card"></i> Оплата и занятия</h5>
        <div class="row">
            <div class="col-md-4 mb-3">
                <label for="price" class="form-label">Тариф</label>
                <select class="form-select" id="price" name="price">
                    <option value="">-- Выберите тариф --</option>
                    {% for price in prices %}
                    <option value="{{ price.id }}"
                            data-price-amount="{{ price.price }}"
                            data-classes-count="{{ price.classes_in_price or 0 }}">
                        {% if price.description %}
                            {{ price.description }} - {{ price.price }} руб.
                        {% else %}
                            Тариф {{ price.id }} - {{ price.price }} руб.
                        {% endif %}
                        {% if price.classes_in_price %}
                            ({{ price.classes_in_price }} занятий)
                        {% endif %}
                    </option>
                    {% endfor %}
                </select>
                <div class="form-text" id="priceInfo"></div>
            </div>
            <div class="col-md-4 mb-3">
                <label for="payment_day" class="form-label">День оплаты</label>
                <input type="number" class="form-control" id="payment_day" name="payment_day" min="1" max="31">
            </div>
            <div class="col-md-4 mb-3">
                <label for="classes_remaining" class="form-label">Осталось занятий</label>
                <input type="number" class="form-control" id="classes_remaining" name="classes_remaining" min="0">
            </div>
        </div>
        <div class="row">
            <div class="col-md-6 mb-3">
                <label for="expected_payment_date" class="form-label">Ожидаемая дата оплата</label>
                <input type="date" class="form-control" id="expected_payment_date" name="expected_payment_date">
            </div>
            <div class="col-md-6 mb-3">
                <label for="date_start" class="form-label">Дата начала тренировок</label>
                <input type="datetime-local" class="form-control" id="date_start" name="date_start">
            </div>
        </div>
    </div>

    <!-- Дополнительно -->
    <div class="form-section">
        <h5 class="section-title"><i class="fas fa-info-circle"></i> Дополнительно</h5>
        <div class="row">
            <div class="col-md-6 mb-3">
                <label for="telegram_id" class="form-label">Telegram ID</label>
                <input type="number" class="form-control" id="telegram_id" name="telegram_id">
            </div>
            <div class="col-md-3 mb-3">
                <label for="parent1" class="form-label">Родитель 1 ID</label>
                <input type="number" class="form-control" id="parent1" name="parent1">
            </div>
            <div class="col-md-3 mb-3">
                <label for="parent2" class="form-label">Родитель 2 ID</label>
                <input type="number" class="form-control" id="parent2" name="parent2">
            </div>
        </div>
    </div>

    <!-- Панель кнопок -->
    <div class="form-section">
        <div class="d-flex flex-wrap gap-2">
            <!-- Основная кнопка сохранения -->
            <button type="button" class="btn btn-primary btn-lg" onclick="saveStudentChanges()">
                <i class="fas fa-save"></i>
                Сохранить изменения
            </button>

            <!-- Дополнительные кнопки -->
            <button type="button" class="btn btn-success btn-lg" onclick="openPaymentModal()">
                <i class="fas fa-credit-card"></i>
                Оплата
            </button>

            <button type="button" class="btn btn-info btn-lg" onclick="openMedicalCertificateModal()">
                <i class="fas fa-file-medical"></i>
                Справка
            </button>

            <button type="button" class="btn btn-warning btn-lg" onclick="openManualBalanceModal()">
                <i class="fas fa-edit"></i>
                Ручной баланс
            </button>

            <button type="button" class="btn btn-secondary btn-lg" onclick="resetForm()">
                <i class="fas fa-undo"></i>
                Сбросить
            </button>

            <a href="/" class="btn btn-outline-secondary btn-lg">
                <i class="fas fa-arrow-left"></i>
                Назад
            </a>
        </div>
    </div>
</form>