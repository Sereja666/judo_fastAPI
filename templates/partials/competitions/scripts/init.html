<!-- templates/partials/competitions/scripts/init.html -->
<script>
    function loadFormData() {
        $.get('/competitions/get-all-data', function(data) {
            allMedCertificates = data.med_cert_types || [];
            allStudents = data.students || [];
            allTrainers = data.trainers || [];

            const trainerSelect = $('#trainerSelect');
            trainerSelect.empty().append('<option value="">Выберите тренера...</option>');
            allTrainers.forEach(trainer => {
                trainerSelect.append(`<option value="${trainer.id}">${trainer.name}</option>`);
            });

            renderCertificatesList();

        }).fail(function() {
            showMessage('Ошибка загрузки данных формы', 'danger');
        });
    }

    function showMessage(text, type) {
        $('#message').html(`
            <div class="alert alert-${type} alert-dismissible fade show" role="alert">
                ${text}
                <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
            </div>
        `);
        setTimeout(() => $('.alert').alert('close'), 5000);
    }



    function formatDateForAPI(date) {
        const year = date.getFullYear();
        const month = String(date.getMonth() + 1).padStart(2, '0');
        const day = String(date.getDate()).padStart(2, '0');
        return `${year}-${month}-${day}`;
    }

    function truncateText(text, maxLength) {
        if (!text) return '';
        if (text.length <= maxLength) return text;
        return text.substring(0, maxLength) + '...';
    }

    function isSameDay(date1, date2) {
        return date1.getDate() === date2.getDate() &&
               date1.getMonth() === date2.getMonth() &&
               date1.getFullYear() === date2.getFullYear();
    }
</script>