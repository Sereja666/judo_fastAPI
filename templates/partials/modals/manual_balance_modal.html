<!-- templates/partials/modals/manual_balance_modal.html -->
<div class="modal fade" id="manualBalanceModal" tabindex="-1" aria-labelledby="manualBalanceModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header bg-warning text-white">
                <h5 class="modal-title" id="manualBalanceModalLabel">
                    <i class="fas fa-edit me-2"></i>
                    Ручное редактирование баланса
                </h5>
                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <div id="manualBalanceAlert" class="alert d-none" role="alert"></div>
                
                <form id="manualBalanceForm">
                    <input type="hidden" id="manualBalanceStudentId" name="student_id">
                    <input type="hidden" id="currentBalanceValue" name="current_balance">
                    
                    <div class="mb-3">
                        <label for="studentBalanceInfo" class="form-label fw-bold">
                            <i class="fas fa-user-graduate me-1"></i>
                            Ученик
                        </label>
                        <div id="studentBalanceInfo" class="card bg-light p-3">
                            <div class="text-center">
                                <div class="spinner-border spinner-border-sm" role="status">
                                    <span class="visually-hidden">Загрузка...</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="mb-3">
                        <label for="newBalance" class="form-label fw-bold">
                            <i class="fas fa-calculator me-1"></i>
                            Новый баланс занятий
                        </label>
                        <div class="input-group input-group-lg">
                            <input type="number" class="form-control" id="newBalance" name="new_balance" 
                                   min="0" max="1000" required>
                            <span class="input-group-text">занятий</span>
                        </div>
                        <div class="form-text">Установите точное количество оставшихся занятий</div>
                    </div>
                    
                    <div class="mb-3">
                        <label class="form-label fw-bold">
                            <i class="fas fa-bolt me-1"></i>
                            Быстрое изменение
                        </label>
                        <div class="d-flex flex-wrap gap-2 mb-2">
                            <button type="button" class="btn btn-outline-primary quick-balance-btn" data-change="-10">
                                -10
                            </button>
                            <button type="button" class="btn btn-outline-primary quick-balance-btn" data-change="-5">
                                -5
                            </button>
                            <button type="button" class="btn btn-outline-primary quick-balance-btn" data-change="-1">
                                -1
                            </button>
                            <button type="button" class="btn btn-outline-primary quick-balance-btn" data-change="+1">
                                +1
                            </button>
                            <button type="button" class="btn btn-outline-primary quick-balance-btn" data-change="+5">
                                +5
                            </button>
                            <button type="button" class="btn btn-outline-primary quick-balance-btn" data-change="+10">
                                +10
                            </button>
                        </div>
                        <div class="form-text">Нажмите для быстрого изменения текущего значения</div>
                    </div>
                    
                    <div class="mb-3">
                        <label for="balanceReason" class="form-label fw-bold">
                            <i class="fas fa-sticky-note me-1"></i>
                            Причина изменения (опционально)
                        </label>
                        <textarea class="form-control" id="balanceReason" name="balance_reason" 
                                  rows="2" placeholder="Например: Корректировка после проверки"></textarea>
                    </div>
                    
                    <div id="balancePreview" class="card border-warning mb-3 d-none">
                        <div class="card-header bg-warning text-white">
                            <i class="fas fa-exchange-alt me-1"></i>
                            Изменение баланса
                        </div>
                        <div class="card-body">
                            <div id="balancePreviewText" class="text-center">
                                <div class="spinner-border spinner-border-sm" role="status">
                                    <span class="visually-hidden">Загрузка...</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
                    <i class="fas fa-times me-1"></i>
                    Отмена
                </button>
                <button type="button" class="btn btn-warning" id="saveManualBalance">
                    <i class="fas fa-save me-1"></i>
                    Сохранить изменения
                </button>
            </div>
        </div>
    </div>
</div>